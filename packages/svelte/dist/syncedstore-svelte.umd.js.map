{"version":3,"file":"syncedstore-svelte.umd.js","sources":["../src/index.ts"],"sourcesContent":["import { readable } from \"svelte/store\";\nimport { Observer, reactive } from \"@reactivedata/reactive\";\n\n/**\n * Svelte helper to enable smart Reactive rerendering of your component.\n *\n * The usage of the return value is automatically tracked.\n * The component where you use this store is then rerendered automatically if any of the\n * used values change.\n *\n * e.g.:\n *\n * // Store setup:\n * const globalStore = SyncedStore({ people: [] });\n * globalStore.items.push({ name: \"Alice\" });\n * globalStore.items.push({ name: \"Bob\" });\n *\n * // In your component:\n * const store = svelteSyncedStore(globalStore);\n * <div>{$store.items[1].name}</div>\n *\n * Now, your component only rerenders when Bob's name changes\n *  (or if the second element of the array changes)\n * \n * Binding values works also.\n * <input type=\"text\" bind:value={$store.items[1].name} />\n */\nexport function svelteSyncedStore<T>(syncedObject: T) {\n  let set: any;\n  const observer = new Observer(() => {\n    if (set) {\n      set(store);\n    }\n  });\n  const store = reactive(syncedObject, observer);\n\n  const readableStore = readable(store, (newSet) => {\n    set = newSet;\n\n    return () => {\n      set = undefined;\n    };\n  });\n\n  return {\n    subscribe: readableStore.subscribe,\n    set: () => {}\n  }\n}\n"],"names":["svelteSyncedStore","syncedObject","set","observer","Observer","store","reactive","readableStore","readable","newSet","undefined","subscribe"],"mappings":";;;;;EAGA;;;;;;;;;;;;;;;;;;;;;;;EAuBG;EACG,SAAUA,iBAAiBA,CAAIC,YAAe,EAAA;EAClD,EAAA,IAAIC,GAAQ,CAAA;EACZ,EAAA,IAAMC,QAAQ,GAAG,IAAIC,iBAAQ,CAAC,YAAK;EACjC,IAAA,IAAIF,GAAG,EAAE;QACPA,GAAG,CAACG,OAAK,CAAC,CAAA;EACX,KAAA;EACH,GAAC,CAAC,CAAA;EACF,EAAA,IAAMA,OAAK,GAAGC,iBAAQ,CAACL,YAAY,EAAEE,QAAQ,CAAC,CAAA;IAE9C,IAAMI,aAAa,GAAGC,cAAQ,CAACH,OAAK,EAAE,UAACI,MAAM,EAAI;EAC/CP,IAAAA,GAAG,GAAGO,MAAM,CAAA;EAEZ,IAAA,OAAO,YAAK;EACVP,MAAAA,GAAG,GAAGQ,SAAS,CAAA;OAChB,CAAA;EACH,GAAC,CAAC,CAAA;IAEF,OAAO;MACLC,SAAS,EAAEJ,aAAa,CAACI,SAAS;EAClCT,IAAAA,GAAG,EAAE,SAALA,GAAGA,GAAO,EAAE;KACb,CAAA;EACH;;;;;;;;"}